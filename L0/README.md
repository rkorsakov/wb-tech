# Задание

**Разработать сервис:**

1. Написать приложение на Go, реализующее описанные ниже функции.
2. Разработать простейший интерфейс для отображения полученных данных по ID заказа.
3. Подключиться и подписаться на канал сообщений: настроить получение данных из брокера сообщений (Kafka).
4. Сохранять полученные данные в БД: при приходе нового сообщения о заказе, парсить его и вставлять соответствующую запись(и) в базу данных (PostgreSQL).
5. Реализовать кэширование данных в сервисе: хранить последние полученные данные заказов в памяти (например, в map), чтобы быстро выдавать их по запросу.
6. При перезапуске восстанавливать кеш из БД: при старте сервиса заполнять кеш актуальными данными из базы, чтобы продолжить обслуживание запросов без задержек.
7. Запустить HTTP-сервер для выдачи данных по ID: реализовать HTTP-эндпоинт, который по order_id будет возвращать данные заказа из кеша (JSON API). Если в кеше данных нет, можно подтягивать из БД.
   - Разработать простой веб-интерфейс — страницу (HTML/JS), где можно ввести ID заказа и получить информацию о нём, обращаясь к вышеописанному HTTP API.

Примечание: модель данных заказа (поля заказа, доставки, оплаты и товаров) прилагается в JSON-файле.

Данные, приходящие из очереди, могут быть невалидными — необходимо предусмотреть обработку ошибок (например, игнорируйте или логируйте некорректные сообщения). В ходе реализации убедитесь, что при сбоях (ошибка базы, падение сервиса) данные не теряются — используйте транзакции, механизм подтверждения сообщений от брокера и т.д.

После реализации убедитесь, что:

1. Сервис подключается к брокеру сообщений (Kafka) и обрабатывает сообщения онлайн (можно написать скрипт-эмулятор отправки сообщений).

2. Кеш действительно ускоряет получение данных (например, при повторных запросах по одному и тому же ID).

3. HTTP-сервер возвращает корректные данные в формате JSON.

Пример запроса:
GET http://localhost:8081/order/<order_uid> должен вернуть JSON с информацией о заказе.

Интерфейс отображает данные понятным образом после ввода ID и нажатия кнопки.

# Описание решения

1. PostgreSQL
    - 4 связанных таблицы (orders, deliveries, payments, items)
    - Работает локально
    - Информация для работы прописывается в конфиге
    - Таблицы создаются при запуске сервиса
2. Kafka
    - Был запущен контейнер с брокером командой  `docker run -d --name=kafka -p 9092:9092 apache/kafka`
    - Информация для работы прописывается в конфиг 
    - Реализован Consumer
    - Сообщения обрабатываются и помещаются в базу данных
3. Проверка работоспособности
    - 2 скрипта: один для генерации JSON, другой для их отправки в топик
4. HTTP сервер
    - Запущен HTTP сервер (Gin)
    - Информация для работы прописывается в конфиг
    - Endpoint `/order/:id`
      - Отдает JSON по id заказа
5. Кэширование //TODO
6. Вэб-интерфейс //TODO

# Make команды

Примечание: переменная GEN_AMOUNT указывает сколько JSON нужно сгенерировать
эту переменную использует команда gen-json, так что необходимо указывать
`make run` - запускает сервис
`make gen-json` - генерирует GEN_AMOUNT JSON и кладет их в testdata
`make send-test` - генерирует JSON и отправляет их в топик